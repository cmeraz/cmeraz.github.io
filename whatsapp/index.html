<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WhatsApp Pro Sender</title>
<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link rel="manifest" href="manifest.json">
<link rel="shortcut icon" type="image/png" href="https://web.whatsapp.com/img/favicon_c5088e888c97ad440a61d247596f88e5.png">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
<style>
  /* Fondo y blur */
  body, html {
    height: 100%;
    margin: 0;
    background: url('https://w0.peakpx.com/wallpaper/818/148/HD-wallpaper-whatsapp-background-cool-dark-green-new-theme-whatsapp.jpg') no-repeat center center fixed;
    background-size: cover;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Segoe UI', sans-serif;
  }
  body::before {
    content: '';
    position: fixed;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(4px);
    z-index: 0;
  }

  /* Card principal */
  .card {
    position: relative;
    z-index: 1;
    width: 100%;
    max-width: 480px;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 12px 30px rgba(0,0,0,0.4);
    background-color: rgba(255, 255, 255, 0.98);
    transform: translateY(50px);
    opacity: 0;
    animation: fadeInUp 0.8s forwards;
  }
  @keyframes fadeInUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Dark mode */
  .dark-mode {
    filter: invert(1) hue-rotate(180deg);
  }

  /* Botones */
  .button {
    transition: all 0.3s ease;
  }
  .button:hover {
    transform: scale(1.05);
    box-shadow: 0 6px 15px rgba(0,0,0,0.3);
  }

  /* Inputs */
  input:focus, select:focus {
    border-color: #25D366;
    box-shadow: 0 0 8px rgba(37, 211, 102, 0.5);
    outline: none;
    transition: all 0.3s ease;
  }

  /* Modal backdrop animado */
  .modal {
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease;
  }
  .modal.is-active {
    opacity: 1;
    pointer-events: all;
  }

  .modal-background {
    background: rgba(0,0,0,0);
    transition: background 0.4s ease;
  }
  .modal.is-active .modal-background {
    background: rgba(0,0,0,0.5);
    backdrop-filter: blur(4px);
  }

  /* Modal card animado */
  .modal-card {
    transform: translateY(-30px) scale(0.8);
    opacity: 0;
    transition: transform 0.4s ease, opacity 0.4s ease;
  }
  .modal.is-active .modal-card {
    transform: translateY(0) scale(1);
    opacity: 1;
  }

  /* Texto animado dentro del modal */
  .modal-card-body ul li {
    opacity: 0;
    transform: translateX(-20px);
    animation: slideText 0.4s forwards;
  }
  .modal-card-body ul li:nth-child(1){ animation-delay: 0.1s; }
  .modal-card-body ul li:nth-child(2){ animation-delay: 0.2s; }
  .modal-card-body ul li:nth-child(3){ animation-delay: 0.3s; }
  .modal-card-body ul li:nth-child(4){ animation-delay: 0.4s; }
  .modal-card-body ul li:nth-child(5){ animation-delay: 0.5s; }
  .modal-card-body ul li:nth-child(6){ animation-delay: 0.6s; }

  @keyframes slideText {
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Historial animado */
  #historyList li {
    opacity: 0;
    transform: translateX(-30px);
    animation: slideIn 0.4s forwards;
  }
  @keyframes slideIn {
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Header botones */
  .buttons-header {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }
</style>
</head>
<body>
<div class="card">
  <header class="card-header has-background-success">
    <p class="card-header-title has-text-white is-size-4">
      <i class="fab fa-whatsapp mr-2"></i> WhatsApp Pro Sender
    </p>
    <div class="buttons-header mr-2">
      <button class="button is-small is-light" onclick="toggleDarkMode()" title="Modo oscuro"><i class="fas fa-adjust"></i></button>
      <button class="button is-small is-light" onclick="openHelp()" title="Ayuda"><i class="fas fa-question-circle"></i></button>
    </div>
  </header>
  <div class="card-content">
    <!-- Selector de pa√≠s -->
    <div class="field">
      <label class="label">Pa√≠s:</label>
      <div class="control">
        <div class="select is-fullwidth">
          <select id="countryCode">
            <option value="52">üá≤üáΩ M√©xico (+52)</option>
            <option value="1">üá∫üá∏ USA (+1)</option>
          </select>
        </div>
      </div>
    </div>

    <!-- N√∫mero -->
    <div class="field">
      <label class="label">Tel√©fono:</label>
      <div class="control has-icons-left">
        <input id="number" class="input" type="tel" placeholder="N√∫mero a 10 d√≠gitos">
        <span class="icon is-small is-left"><i class="fas fa-phone"></i></span>
      </div>
    </div>

    <!-- Mensaje -->
    <div class="field">
      <label class="label">Mensaje:</label>
      <div class="control has-icons-left">
        <input id="message" class="input" type="text" placeholder="Escribe tu mensaje">
        <span class="icon is-small is-left"><i class="fas fa-comment-alt"></i></span>
      </div>
    </div>

    <!-- Mensajes r√°pidos: rese√±a y tienda -->
    <div class="buttons is-centered">
      <button class="button is-small is-info" onclick="quickMsg(reviewMsg)">
        <i class="fas fa-star mr-1"></i> Dejar rese√±a
      </button>
      <button class="button is-small is-warning" onclick="quickMsg(storeMsg)">
        <i class="fas fa-store mr-1"></i> Visitar tienda
      </button>
    </div>

    <!-- Botones principales -->
    <div class="field is-grouped is-grouped-centered mt-3">
      <p class="control">
        <button id="sendBtn" class="button is-success"><i class="fas fa-paper-plane"></i> Enviar</button>
      </p>
      <p class="control">
        <button class="button is-light" onclick="clearInputs()"><i class="fas fa-eraser"></i> Limpiar</button>
      </p>
    </div>

    <!-- Historial -->
    <div class="mt-4">
      <p class="title is-6">Historial</p>
      <ul id="historyList" class="menu-list"></ul>
      <button class="button is-small is-danger mt-2" onclick="clearHistory()">Borrar historial</button>
    </div>
  </div>
</div>

<!-- Modal de ayuda animado -->
<div id="helpModal" class="modal">
  <div class="modal-background" onclick="closeHelp()"></div>
  <div class="modal-card">
    <header class="modal-card-head">
      <p class="modal-card-title">Ayuda</p>
      <button class="delete" aria-label="close" onclick="closeHelp()"></button>
    </header>
    <section class="modal-card-body">
      <ul>
        <li>Selecciona el pa√≠s y escribe el n√∫mero de tel√©fono (sin espacios ni guiones).</li>
        <li>Escribe el mensaje o usa los botones de mensajes r√°pidos.</li>
        <li>Haz clic en <b>Enviar</b> para abrir WhatsApp.</li>
        <li>El historial guarda tus √∫ltimos 10 mensajes para reutilizarlos.</li>
        <li>Usa <b>Limpiar</b> para borrar los campos.</li>
        <li>Activa <b>Modo oscuro</b> si quieres un fondo invertido.</li>
      </ul>
    </section>
    <footer class="modal-card-foot">
      <button class="button is-success" onclick="closeHelp()">Cerrar</button>
    </footer>
  </div>
</div>

<script>
  // Mensajes r√°pidos como variables
  const reviewMsg = "¬°Hola! Me encantar√≠a que dejaras tu rese√±a: https://tusitio.com/review";
  const storeMsg = "¬°Hola! Mira nuestra tienda en l√≠nea: https://tienda.tusitio.com";

  function quickMsg(msg){
    const number = document.getElementById('number').value;
    const country = document.getElementById('countryCode').value;
    if(!number) return alert("Por favor ingresa un n√∫mero de tel√©fono.");
    const url = `https://wa.me/${country}${number}?text=${encodeURIComponent(msg)}`;
    window.open(url, '_blank');
  }

  function clearInputs(){
    document.getElementById('number').value = '';
    document.getElementById('message').value = '';
  }

  function clearHistory(){
    document.getElementById('historyList').innerHTML = '';
  }

  function toggleDarkMode(){
    document.body.classList.toggle('has-background-dark');
    document.body.classList.toggle('has-text-white');
  }

  function openHelp(){ document.getElementById('helpModal').classList.add('is-active'); }
  function closeHelp(){ document.getElementById('helpModal').classList.remove('is-active'); }
</script>



<script>
  const numberInput = document.getElementById('number');
  const messageInput = document.getElementById('message');
  const historyList = document.getElementById('historyList');
  const countrySelect = document.getElementById('countryCode');

  function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
  }

  function quickMsg(msg) {
    messageInput.value = msg;
  }

  function saveHistory(num, msg) {
    let hist = JSON.parse(localStorage.getItem('whatsappHistory')) || [];
    hist.unshift({ num, msg, date: new Date().toLocaleString() });
    hist = hist.slice(0, 10);
    localStorage.setItem('whatsappHistory', JSON.stringify(hist));
    renderHistory();
  }

  function renderHistory() {
    historyList.innerHTML = '';
    const hist = JSON.parse(localStorage.getItem('whatsappHistory')) || [];
    hist.forEach((item, idx) => {
      const li = document.createElement('li');
      li.style.animationDelay = `${idx * 0.1}s`;
      li.innerHTML = `<a onclick="useHistory('${item.num}', '${item.msg}')">
        ${item.num} - ${item.msg} <small>(${item.date})</small>
      </a>`;
      historyList.appendChild(li);
    });
  }

  function useHistory(num, msg) {
    numberInput.value = num;
    messageInput.value = msg;
  }

  function clearInputs() {
    numberInput.value = '';
    messageInput.value = '';
    numberInput.focus();
  }

  function clearHistory() {
    localStorage.removeItem('whatsappHistory');
    renderHistory();
  }

  function sendMessage() {
    let num = numberInput.value.replace(/\D/g, '');
    const msg = messageInput.value.trim();
    const prefix = countrySelect.value;

    if (!/^\d{8,15}$/.test(num)) {
      alert('N√∫mero inv√°lido. Ingresa entre 8 y 15 d√≠gitos.');
      return;
    }
    if(msg === ''){
      alert('Escribe un mensaje antes de enviar');
      return;
    }

    saveHistory(num, msg);

    const isMobile = /Android|iPhone|iPad/i.test(navigator.userAgent);
    const url = isMobile
      ? `https://wa.me/${prefix}${num}?text=${encodeURIComponent(msg)}`
      : `https://web.whatsapp.com/send?phone=${prefix}${num}&text=${encodeURIComponent(msg)}`;

    window.open(url, '_blank');
  }

  document.getElementById('sendBtn').addEventListener('click', sendMessage);
  messageInput.addEventListener('keypress', function(e){
    if(e.key === 'Enter') sendMessage();
  });

  function openHelp() {
    document.getElementById('helpModal').classList.add('is-active');
  }
  function closeHelp() {
    document.getElementById('helpModal').classList.remove('is-active');
  }

  window.onload = () => {
    renderHistory();
    numberInput.focus();
  };

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js')
      .then(() => console.log('Service Worker registrado'));
  };
</script>
</body>
</html>
